import{o as p,a as w}from"./chunk-ZQRKUG6J-Z4ocpRBU.js";import{F}from"./chunk-TYTNUPXB-Dgs-8q3u.js";import{c as _}from"./chunk-6GU6IDUA-CDc7wW5L.js";import{ac as i,an as v,b as E,r as y,j as s,v as c}from"./index-CfFT3zi1.js";var R=t=>{var e,r,g,l,d,m,h,u,b,f;const o=(r=(e=t.media)==null?void 0:e.find(a=>a.isThumbnail))==null?void 0:r.url,n=(g=t.media)==null?void 0:g.filter(a=>!a.isThumbnail).map(a=>({url:a.url}));return{status:t.status,is_giftcard:!1,tags:(l=t==null?void 0:t.tags)!=null&&l.length?(d=t.tags)==null?void 0:d.map(a=>({id:a})):void 0,sales_channels:(m=t==null?void 0:t.sales_channels)!=null&&m.length?(h=t.sales_channels)==null?void 0:h.map(a=>({id:a.id})):void 0,images:n,collection_id:t.collection_id||void 0,shipping_profile_id:t.shipping_profile_id||void 0,categories:t.categories.map(a=>({id:a})),type_id:t.type_id||void 0,handle:(u=t.handle)==null?void 0:u.trim(),origin_country:t.origin_country||void 0,material:t.material||void 0,mid_code:t.mid_code||void 0,hs_code:t.hs_code||void 0,thumbnail:o,title:t.title.trim(),subtitle:(b=t.subtitle)==null?void 0:b.trim(),description:(f=t.description)==null?void 0:f.trim(),discountable:t.discountable,width:t.width?parseFloat(t.width):void 0,length:t.length?parseFloat(t.length):void 0,height:t.height?parseFloat(t.height):void 0,weight:t.weight?parseFloat(t.weight):void 0,options:t.options.filter(a=>a.title),variants:x(t.variants.filter(a=>a.should_create),t.regionsCurrencyMap)}},x=(t,o)=>t.map(n=>({title:n.title||Object.values(n.options||{}).join(" / "),options:n.options,sku:n.sku||void 0,manage_inventory:!!n.manage_inventory,allow_backorder:!!n.allow_backorder,variant_rank:n.variant_rank,inventory_items:n.inventory.map(e=>{const r=e.required_quantity?_(e.required_quantity):null;return!e.inventory_item_id||!r?!1:{...e,required_quantity:r}}).filter(e=>e!==!1),prices:Object.entries(n.prices||{}).map(([e,r])=>{if(!(r===""||r===void 0))return e.startsWith("reg_")?{currency_code:o[e],amount:_(r),rules:{region_id:e}}:{currency_code:e,amount:_(r)}}).filter(e=>!!e)})),S=t=>t.map(o=>({...o,title:o.title||"",sku:o.sku||"",manage_inventory:o.manage_inventory||!1,allow_backorder:o.allow_backorder||!1,inventory_kit:o.inventory_kit||!1})),k=i.object({id:i.string().optional(),url:i.string(),isThumbnail:i.boolean(),file:i.any().nullable()}),T=i.object({should_create:i.boolean(),is_default:i.boolean().optional(),title:i.string(),upc:i.string().optional(),ean:i.string().optional(),barcode:i.string().optional(),mid_code:i.string().optional(),hs_code:i.string().optional(),width:p,height:p,length:p,weight:p,material:i.string().optional(),origin_country:i.string().optional(),sku:i.string().optional(),manage_inventory:i.boolean().optional(),allow_backorder:i.boolean().optional(),inventory_kit:i.boolean().optional(),options:i.record(i.string(),i.string()),variant_rank:i.number(),prices:i.record(i.string(),w).optional(),inventory:i.array(i.object({inventory_item_id:i.string(),required_quantity:p})).optional()}),q=i.object({title:i.string(),values:i.array(i.string()).min(1)}),M=i.object({title:i.string().min(1),subtitle:i.string().optional(),handle:i.string().optional(),description:i.string().optional(),discountable:i.boolean(),type_id:i.string().optional(),collection_id:i.string().optional(),shipping_profile_id:i.string().optional(),categories:i.array(i.string()),tags:i.array(i.string()).optional(),sales_channels:i.array(i.object({id:i.string(),name:i.string()})).optional(),origin_country:i.string().optional(),material:i.string().optional(),width:i.string().optional(),length:i.string().optional(),height:i.string().optional(),weight:i.string().optional(),mid_code:i.string().optional(),hs_code:i.string().optional(),options:i.array(q).min(1),enable_variants:i.boolean(),variants:i.array(T).min(1),media:i.array(k).optional()}).superRefine((t,o)=>{if(t.variants.every(e=>!e.should_create))return o.addIssue({code:i.ZodIssueCode.custom,path:["variants"],message:"invalid_length"});const n=new Set;t.variants.forEach((e,r)=>{e.sku&&(n.has(e.sku)&&o.addIssue({code:i.ZodIssueCode.custom,path:[`variants.${r}.sku`],message:v.t("products.create.errors.uniqueSku")}),n.add(e.sku))})}),U=i.object({media:i.array(k)}),N={discountable:!0,tags:[],sales_channels:[],options:[{title:"Default option",values:["Default option value"]}],variants:S([{title:"Default variant",should_create:!0,variant_rank:0,options:{"Default option":"Default option value"},inventory:[{inventory_item_id:"",required_quantity:""}],is_default:!0}]),enable_variants:!1,media:[],categories:[],collection_id:"",shipping_profile_id:"",description:"",handle:"",height:"",hs_code:"",length:"",material:"",mid_code:"",origin_country:"",subtitle:"",title:"",type_id:"",weight:"",width:""},j=["image/jpeg","image/png","image/gif","image/webp","image/heic","image/svg+xml"],I=[".jpeg",".png",".gif",".webp",".heic",".svg"],V=({form:t,append:o,showHint:n=!0})=>{const{t:e}=E(),r=y.useCallback(l=>{const d=l.find(m=>!j.includes(m.file.type));return d?(t.setError("media",{type:"invalid_file",message:e("products.media.invalidFileType",{name:d.file.name,types:I.join(", ")})}),!0):!1},[t,e]),g=y.useCallback(l=>{t.clearErrors("media"),!r(l)&&l.forEach(d=>o({...d,isThumbnail:!1}))},[t,o,r]);return s.jsx(c.Field,{control:t.control,name:"media",render:()=>s.jsx(c.Item,{children:s.jsxs("div",{className:"flex flex-col gap-y-2",children:[s.jsxs("div",{className:"flex flex-col gap-y-1",children:[s.jsx(c.Label,{optional:!0,children:e("products.media.label")}),n&&s.jsx(c.Hint,{children:e("products.media.editHint")})]}),s.jsx(c.Control,{children:s.jsx(F,{label:e("products.media.uploadImagesLabel"),hint:e("products.media.uploadImagesHint"),hasError:!!t.formState.errors.media,formats:j,onUploaded:g})}),s.jsx(c.ErrorMessage,{})]})})})};export{U as E,M as P,V as U,N as a,S as d,R as n};
