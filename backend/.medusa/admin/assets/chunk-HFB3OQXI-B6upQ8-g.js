import{cn as D,co as S,r as f,cp as B,k as C}from"./index-DuPjH3KB.js";var I=()=>{const[r,s]=f.useState(""),[o,t]=f.useState(""),i=f.useCallback(B(n=>t(n),300),[]);return f.useEffect(()=>(i(r),()=>i.cancel()),[r,i]),{searchValue:r,onSearchValueChange:s,query:o||void 0}},k=({queryKey:r,queryFn:s,getOptions:o,defaultValue:t,defaultValueKey:i,selectedValue:n,pageSize:x=10,enabled:c=!0})=>{const{searchValue:h,onSearchValueChange:q,query:l}=I(),E=i||"id",{data:m}=D({queryKey:[...r,t].filter(Boolean),queryFn:async()=>s({[E]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&c}),{data:d}=D({queryKey:[...r,n].filter(Boolean),queryFn:async()=>s({id:n,limit:1}),enabled:!!n&&c}),{data:y,...b}=S({queryKey:[...r,"_cbx_",l].filter(Boolean),queryFn:async({pageParam:e=0})=>await s({q:l,limit:x,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:C,enabled:c}),a=(y==null?void 0:y.pages.flatMap(e=>o(e)))??[],v=m?o(m):[],p=d?o(d):[],g=!b.isPending&&!a.length&&!h||!c;return t&&v.length&&!h&&v.forEach(e=>{a.find(u=>u.value===e.value)||a.unshift(e)}),n&&p.length&&p.forEach(e=>{a.find(u=>u.value===e.value)||a.unshift(e)}),{options:a,searchValue:h,onSearchValueChange:q,disabled:g,...b}};export{I as a,k as u};
